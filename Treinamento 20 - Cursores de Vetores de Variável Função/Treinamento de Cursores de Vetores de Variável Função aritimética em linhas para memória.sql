/* CURSORES TREINAMENTO 20*/

CREATE DATABASE CURSORES;
USE CURSORES;

CREATE TABLE VENDEDORES(
	IDVENDEDOR INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR(50),
	JAN INT,
	FEV INT,
	MAR INT

);

INSERT INTO VENDEDORES VALUES (NULL, 'João', 10000, 20000, 30000);
INSERT INTO VENDEDORES VALUES (NULL, 'Maria', 15000, 25000, 35000);
INSERT INTO VENDEDORES VALUES (NULL, 'Pedro', 12000, 22000, 32000);
INSERT INTO VENDEDORES VALUES (NULL, 'Ana', 18000, 28000, 38000);
INSERT INTO VENDEDORES VALUES (NULL, 'Carlos', 16000, 26000, 36000);
INSERT INTO VENDEDORES VALUES (NULL, 'Sandra', 11000, 21000, 31000);
INSERT INTO VENDEDORES VALUES (NULL, 'Mariana', 13000, 23000, 33000);
INSERT INTO VENDEDORES VALUES (NULL, 'Fernando', 17000, 27000, 37000);
INSERT INTO VENDEDORES VALUES (NULL, 'Isabela', 19000, 29000, 39000);
INSERT INTO VENDEDORES VALUES (NULL, 'Lucas', 14000, 24000, 34000);
INSERT INTO VENDEDORES VALUES (NULL, 'Juliana', 20000, 30000, 40000);
INSERT INTO VENDEDORES VALUES (NULL, 'Ricardo', 21000, 31000, 41000);
INSERT INTO VENDEDORES VALUES (NULL, 'Camila', 22000, 32000, 42000);
INSERT INTO VENDEDORES VALUES (NULL, 'Gustavo', 23000, 33000, 43000);
INSERT INTO VENDEDORES VALUES (NULL, 'Laura', 24000, 34000, 44000);
INSERT INTO VENDEDORES VALUES (NULL, 'Marcos', 25000, 35000, 45000);
INSERT INTO VENDEDORES VALUES (NULL, 'Carolina', 26000, 36000, 46000);
INSERT INTO VENDEDORES VALUES (NULL, 'Rafael', 27000, 37000, 47000);
INSERT INTO VENDEDORES VALUES (NULL, 'Amanda', 28000, 38000, 48000);
INSERT INTO VENDEDORES VALUES (NULL, 'Gabriel', 29000, 39000, 49000);
INSERT INTO VENDEDORES VALUES (NULL, 'Maxswell', 43561, 89125, 35645);

SELECT NOME, (JAN+FEV+MAR) AS TOTAL FROM VENDEDORES;
SELECT NOME, (JAN+FEV+MAR)/3 AS MÉDIA FROM VENDEDORES;

-- COM MUITOS DADOS O TEMPO DE EXECUTAR PODE GERAR LENTIDÃO. PARA ISSO CRIAMOS OUTRA TABELA 
-- E USAREMOS O CURSOR PARA DEIXAR OS DADOS REGISTRADO NA MEMÓRIA EM LOOP

CREATE TABLE VENDA_TOTAL(
	NOME VARCHAR(50),
	JAN INT,
	FEV INT,
	MAR INT,
	TOTAL INT,
	MEDIA INT
);


-- INICIANDO A PROGRAMAÇÃO CURSOR DENTRO DA PRODECURE


		#DECLARE A VÁRIÁVEL COM DECLARE SEGUIDO DO NOME DA VARIÁVEL
		

# DECLARANDO A VARIÁVEL CURSOR PARA ARMAZENAR O RESULTADO DA QUERYCOM REG DE REGISTRO
		
# INSERINDO UMA LINHA PADRÃO QUE NÃO VAI MUDAR, ELE VAI OLHAR OS DADOS EM LOOP
#USANDO VARIÁVEL DE MANIPULAÇÃO CONTINUA O HANDLER
		
# USANDO O OPEN REG PARA PEGAR O RESULTADO DA VARIÁVEL REG E JOGAR NA MEMÓRIA RAM
	

		# INICIANDO O LOOP COM FETCH REG PARA BUSCAR SEMPRE O PRÓXIMO REGISTRO
		